(this["webpackJsonpweb-sockets-chat"]=this["webpackJsonpweb-sockets-chat"]||[]).push([[0],{41:function(e,t,n){},73:function(e,t,n){},75:function(e,t,n){"use strict";n.r(t);var a=n(6),s=n.n(a),c=n(31),o=n.n(c),i=(n(41),n(12)),r=n(32),u=n(33),l=n(36),m=n(35),h=n(34),g=(n(73),n(0));var d,j=function(e){return Object(g.jsx)("header",{className:"App-header",children:Object(g.jsx)("h1",{children:e.title})})};function b(e){return Object(g.jsx)("main",{children:Object(g.jsx)("div",{children:e.children})})}function p(e){return Object(g.jsx)("div",{className:e.type,children:Object(g.jsx)(e.elem,{children:e.message})})}function f(e){var t=e.form;return Object(g.jsxs)("form",{onSubmit:e.onFormSubmit,className:t.class,method:"POST",children:[Object(g.jsx)("input",{type:"text",name:"name",autoComplete:"off",className:t.input.class,placeholder:t.input.placeholder,"aria-label":t.input.ariaLabel,value:e.inputValue,onChange:function(t){return e.onInputChange(t)}}),Object(g.jsx)("button",{type:"submit",className:"button",children:t.buttonText})]})}function O(e){return e.isVisible?Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)("div",{className:"welcome-area",children:Object(g.jsx)(f,{form:{input:{placeholder:"Please enter your name...",ariaLabel:"Enter a name to be used in the chat room",class:"welcome-area-form-input"},buttonText:"Send",class:"welcome-area-form"},inputValue:e.name,onInputChange:function(t){e.onNameChange(t)},onFormSubmit:function(t){e.onNameSubmit(t)}})}),e.hasAnyConnectionError?Object(g.jsx)(p,{type:"error",elem:"p",message:e.notification.message}):null]}):null}function y(e){var t=Object(a.useRef)();return Object(a.useEffect)((function(){t&&t.current&&function(){t.current.scrollIntoView(!0);var e=document.querySelector(".chat-area .chat-area-box");e&&(e.scrollTop+=10)}()})),Object(g.jsxs)("div",{className:e.type,children:[Object(g.jsx)("div",{className:"sender",children:e.sender}),Object(g.jsx)("div",{className:"message",children:Object(g.jsx)("span",{ref:t,children:e.message})})]})}function x(e){return e.messages.length>0?Object(g.jsx)("div",{className:"message-list",children:e.messages.map((function(e,t){return Object(g.jsx)(y,{type:e.type,sender:e.name||null,message:e.message},e.id||t)}))}):null}function v(e){return e.isVisible?Object(g.jsxs)("div",{className:"chat-area",children:[Object(g.jsxs)("div",{className:"chat-area-box",children:[Object(g.jsx)(x,{messages:e.chat}),e.typing.enabled?Object(g.jsx)(p,{type:"temporary",elem:"span",message:e.typing.message}):null]}),Object(g.jsx)("div",{className:"chat-area-form-wrapper",children:Object(g.jsx)(f,{form:{input:{placeholder:"Write a message ...",ariaLabel:"Enter message to send",class:"chat-area-form-input"},buttonText:"Send",class:"chat-area-form"},inputValue:e.messageOut,onInputChange:function(t){e.onMessageChange(t)},onFormSubmit:function(t){e.onMessageSend(t)}})})]}):null}!function(e){e.TITLE="Silviu's Chat Application",e.WELCOME="Welcome, "}(d||(d={}));var C=function(e){Object(l.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).socket=void 0,a.url="/",a.title=d.TITLE,a.connected=!1,a.name="",a.messageOut="",a.chat=[],a.typing={message:"",enabled:!1},a.notification={message:"",type:"message"},a.hasAnyConnectionError=!1,a.state={title:a.title,connected:a.connected,name:a.name,messageOut:a.messageOut,chat:a.chat,typing:a.typing,notification:a.connected,hasAnyConnectionError:a.hasAnyConnectionError},a.resetTyping=function(){a.setState({typing:{enabled:!1,message:""}})},a.joinRoom=function(e){e&&e.preventDefault();var t=a.state,n=t.connected,s=t.name;n||(a.socket.emit("join room",{name:s}),a.socket.on("connection success",(function(e){a.setState({connected:!0,title:d.WELCOME+s,notification:{message:e,type:"message"},chat:[].concat(Object(i.a)(a.state.chat),[{id:a.state.chat.length+1,message:e,type:"notification"}]),hasAnyConnectionError:!1})})),a.socket.on("connection error",(function(e){a.setState({connected:!1,notification:{message:e,type:"error"},hasAnyConnectionError:!0})})))},a.sendMessage=function(e){e&&e.preventDefault(),a.state.connected&&a.handleMessageOut()},a.handleMessageOut=function(){var e={id:a.state.chat.length+1,name:a.state.name,message:a.state.messageOut,type:"message-out"};a.socket.emit("send message",e),a.setState({chat:[].concat(Object(i.a)(a.state.chat),[e]),messageOut:""})},a.onNameChange=function(e){var t=e.target.value||"";a.setState({name:t})},a.onMessageChange=function(e){a.socket.emit("start typing",{name:a.state.name});var t=e.target.value||"";a.setState({messageOut:t})},a.socket=Object(h.io)(a.url,{transports:["polling"]}),a}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.socket.on("message",(function(t){var n=t.message,a=t.sender;e.setState({chat:[].concat(Object(i.a)(e.state.chat),[{id:e.state.chat.length+1,name:a,message:n,type:"message-in"}])},(function(){return e.resetTyping()}))})),this.socket.on("typing",(function(t){e.setState({typing:{enabled:!0,message:t}}),setTimeout((function(){e.resetTyping()}),4e3)}))}},{key:"render",value:function(){var e=this.state,t=e.title,n=e.connected,a=e.hasAnyConnectionError,s=e.chat,c=e.typing,o=e.messageOut,i=e.notification,r=e.name;return Object(g.jsxs)("div",{className:"App",children:[Object(g.jsx)(j,{title:t}),Object(g.jsxs)(b,{children:[Object(g.jsx)(O,{isVisible:!n,name:r,onNameSubmit:this.joinRoom,onNameChange:this.onNameChange,hasAnyConnectionError:a,notification:i}),Object(g.jsx)(v,{isVisible:n,chat:s,typing:c,messageOut:o,onMessageChange:this.onMessageChange,onMessageSend:this.sendMessage})]})]})}}]),n}(s.a.Component),S=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,76)).then((function(t){var n=t.getCLS,a=t.getFID,s=t.getFCP,c=t.getLCP,o=t.getTTFB;n(e),a(e),s(e),c(e),o(e)}))};o.a.render(Object(g.jsx)(s.a.StrictMode,{children:Object(g.jsx)(C,{})}),document.getElementById("root")),S()}},[[75,1,2]]]);
//# sourceMappingURL=main.142e95bb.chunk.js.map